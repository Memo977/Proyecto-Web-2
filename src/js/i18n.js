window.translations = {
    en: {
        home: "Home",
        categories: "Categories",
        searchPlaceholder: "Search posts...",
        about: "About",
        sportsCars: "Sports Cars",
        raceCars: "Race Cars",
        welcomeTitle: "Welcome to AutoBlog",
        welcomeSubtitle: "Your source for the latest car news and reviews",
        recentPosts: "Recent Posts",
        logout: "Logout",
        by: "By",
        readMore: "Read more",
        noResults: "No results found.",
        categoryMismatch: "Some results belong to different categories than the current one.",
        postNotFound: "Post not found",
        loginToRate: "You must log in to rate",
        passwordTooShort: "Password must be at least 8 characters long.",
        incorrectCredentials: "Incorrect username or password.",
        languageOptions: {
            es: "Español",
            ar: "العربية"
        },
        raceCarsTitle: "Race Cars",
        raceCarsSubtitle: "Explore the fastest vehicles designed for competition",
        raceCarsPostsTitle: "Race Car Posts",
        sportsCarsTitle: "Sports Cars",
        sportsCarsSubtitle: "Discover the most powerful and elegant vehicles on the market",
        sportsCarsPostsTitle: "Sports Car Posts",
        loginTitle: "Login",
        username: "Username",
        password: "Password",
        loginButton: "Login",
        loginErrorShortPassword: "The password must be at least 8 characters long.",
        loginErrorInvalidCredentials: "Incorrect username or password.",
        footerText: "© 2024 AutoBlog. All rights reserved.",
        aboutHeroTitle: "About AutoBlog",
        aboutHeroSubtitle: "Discover our passion for cars",
        aboutAuthorTitle: "Blog Author",
        aboutAuthorName: "Guillermo Solórzano Ochoa",
        aboutAuthorRole: "Founder and Editor of AutoBlog",
        aboutAuthorBio: "I am a Software Engineering student, passionate about the automotive world. I founded AutoBlog in 2024 as a class project to share my knowledge and passion for sports and race cars.",
        aboutAutoBlogTitle: "About AutoBlog",
        aboutAutoBlogDescription: "AutoBlog is your reliable source for news, reviews, and analysis on sports and race cars. We focus on providing high-quality, up-to-date, and relevant content for enthusiasts and professionals in the automotive world.",
        aboutSimilarSitesTitle: "Similar Sites",
        autoblogDescription: "Car news and reviews",
        motorTrendDescription: "Automotive magazine and website",
        carAndDriverDescription: "Specialized car magazine",
        topGearDescription: "Website of the famous TV show",
        githubDescription: " - My code repositories",
        facebookDescription: " - Connect with me",
        instagramDescription: " - Follow my photos"
    },
    es: {
        home: "Inicio",
        categories: "Categorías",
        searchPlaceholder: "Buscar posts...",
        about: "Acerca de",
        sportsCars: "Autos deportivos",
        raceCars: "Autos de carrera",
        welcomeTitle: "Bienvenido a AutoBlog",
        welcomeSubtitle: "Tu fuente para las últimas noticias y reseñas de autos",
        recentPosts: "Posts recientes",
        logout: "Cerrar sesión",
        by: "Por",
        readMore: "Leer más",
        noResults: "No se encontraron resultados.",
        categoryMismatch: "Algunos resultados pertenecen a categorías diferentes a la actual.",
        postNotFound: "Post no encontrado",
        loginToRate: "Debes iniciar sesión para calificar",
        passwordTooShort: "La contraseña debe tener al menos 8 caracteres.",
        incorrectCredentials: "Usuario o contraseña incorrectos.",
        languageOptions: {
            en: "English",
            ar: "العربية"
        },
        raceCarsTitle: "Autos de Carrera",
        raceCarsSubtitle: "Explora los vehículos más rápidos diseñados para la competición",
        raceCarsPostsTitle: "Posts de Autos de Carrera",
        sportsCarsTitle: "Autos Deportivos",
        sportsCarsSubtitle: "Descubre los vehículos más potentes y elegantes del mercado",
        sportsCarsPostsTitle: "Posts de Autos Deportivos",
        loginTitle: "Iniciar sesión",
        username: "Usuario",
        password: "Contraseña",
        loginButton: "Iniciar sesión",
        loginErrorShortPassword: "La contraseña debe tener al menos 8 caracteres.",
        loginErrorInvalidCredentials: "Usuario o contraseña incorrectos.",
        footerText: "© 2024 AutoBlog. Todos los derechos reservados.",
        aboutHeroTitle: "Acerca de AutoBlog",
        aboutHeroSubtitle: "Descubre nuestra pasión por los autos",
        aboutAuthorTitle: "Autor del Blog",
        aboutAuthorName: "Guillermo Solórzano Ochoa",
        aboutAuthorRole: "Fundador y Editor de AutoBlog",
        aboutAuthorBio: "Soy un estudiante de Ingeniería de Software, apasionado del mundo automotriz. Fundé AutoBlog en 2024 como proyecto de clase para compartir mi conocimiento y pasión por los autos deportivos y de carrera.",
        aboutAutoBlogTitle: "Sobre AutoBlog",
        aboutAutoBlogDescription: "AutoBlog es tu fuente confiable de noticias, reseñas y análisis sobre autos deportivos y de carrera. Nos enfocamos en proporcionar contenido de alta calidad, actualizado y relevante para entusiastas y profesionales del mundo automotriz.",
        aboutSimilarSitesTitle: "Sitios Similares",
        autoblogDescription: "Noticias y reseñas de autos",
        motorTrendDescription: "Revista y sitio web de automovilismo",
        carAndDriverDescription: "Revista especializada en autos",
        topGearDescription: "Sitio web del famoso programa de TV",
        githubDescription: " - Mis repositorios de código",
        facebookDescription: " - Conéctate conmigo",
        instagramDescription: " - Sigue mis fotos"
    },
    ar: {
        home: "الصفحة الرئيسية",
        categories: "الفئات",
        searchPlaceholder: "ابحث في المشاركات...",
        about: "معلومات عنا",
        sportsCars: "السيارات الرياضية",
        raceCars: "سيارات السباق",
        welcomeTitle: "مرحبا بكم في أوتو بلوغ",
        welcomeSubtitle: "مصدر الأخبار والمراجعات الخاصة بالسيارات",
        recentPosts: "أحدث المشاركات",
        logout: "تسجيل خروج",
        by: "بواسطة",
        readMore: "اقرأ أكثر",
        noResults: "لم يتم العثور على نتائج.",
        categoryMismatch: "بعض النتائج تنتمي إلى فئات مختلفة عن الفئة الحالية.",
        postNotFound: "المنشور غير موجود",
        loginToRate: "يجب عليك تسجيل الدخول للتقييم",
        passwordTooShort: "يجب أن تحتوي كلمة المرور على 8 أحرف على الأقل.",
        incorrectCredentials: "اسم المستخدم أو كلمة المرور غير صحيحة.",
        languageOptions: {
            en: "English",
            es: "Español"
        },
        raceCarsTitle: "سيارات السباق",
        raceCarsSubtitle: "استكشف أسرع السيارات المصممة للمنافسة",
        raceCarsPostsTitle: "منشورات سيارات السباق",
        sportsCarsTitle: "السيارات الرياضية",
        sportsCarsSubtitle: "اكتشف أقوى وأجمل السيارات في السوق",
        sportsCarsPostsTitle: "منشورات السيارات الرياضية",
        loginTitle: "تسجيل الدخول",
        username: "اسم المستخدم",
        password: "كلمه السر",
        loginButton: "تسجيل الدخول",
        loginErrorShortPassword: "يجب أن تحتوي كلمة المرور على 8 أحرف على الأقل.",
        loginErrorInvalidCredentials: "اسم المستخدم أو كلمة المرور غير صحيحة.",
        footerText: "© 2024 أوتو بلوغ. جميع الحقوق محفوظة.",
        aboutHeroTitle: "حول أوتو بلوغ",
        aboutHeroSubtitle: "اكتشف شغفنا بالسيارات",
        aboutAuthorTitle: "مؤلف المدونة",
        aboutAuthorName: "غييرمو سولورزانو أوتشوا",
        aboutAuthorRole: "مؤسس ومحرر أوتو بلوغ",
        aboutAuthorBio: "أنا طالب هندسة برمجيات، شغوف بعالم السيارات. أسست أوتو بلوغ في عام 2024 كمشروع دراسي لمشاركة معرفتي وشغفي بالسيارات الرياضية وسيارات السباق.",
        aboutAutoBlogTitle: "عن أوتو بلوغ",
        aboutAutoBlogDescription: "أوتو بلوغ هو مصدرك الموثوق للأخبار والمراجعات والتحليلات حول السيارات الرياضية وسيارات السباق. نركز على تقديم محتوى عالي الجودة، محدث وذو صلة للمهتمين والمحترفين في عالم السيارات.",
        aboutSimilarSitesTitle: "مواقع مماثلة",
        autoblogDescription: "أخبار ومراجعات السيارات",
        motorTrendDescription: "مجلة وموقع إلكتروني للسيارات",
        carAndDriverDescription: "مجلة متخصصة في السيارات",
        topGearDescription: "الموقع الإلكتروني للبرنامج التلفزيوني الشهير",
        githubDescription: " - مستودعات الكود الخاصة بي",
        facebookDescription: " - تواصل معي",
        instagramDescription: " - تابع صوري"
    }
};

function getCurrentLang() {
    return localStorage.getItem('preferredLanguage') || document.documentElement.lang || 'es';
}

function switchLanguage(lang) {
    window.currentLang = lang;
    localStorage.setItem('preferredLanguage', lang);
    document.documentElement.lang = lang;
    updateContent();
    updateLanguageSelector();
    if (document.getElementById('post-content')) {
        updatePostContent();
    }
    if (document.getElementById('posts-container')) {
        window.displayPosts();
    }
    window.dispatchEvent(new Event('languageChanged'));
}

function updateLanguageSelector() {
    const languageSelector = document.querySelector('.language-selector');
    if (!languageSelector) return;

    languageSelector.innerHTML = '';
    const currentLang = getCurrentLang();
  
    Object.entries(translations[currentLang].languageOptions).forEach(([lang, name]) => {
        const button = document.createElement('button');
        button.textContent = name;
        button.onclick = () => switchLanguage(lang);
        languageSelector.appendChild(button);
    });
}

function updateContent() {
    const currentLang = getCurrentLang();

    const homeLink = document.querySelector('.header__link[href="/src/pages/home.html"]');
    if (homeLink) homeLink.textContent = translations[currentLang].home;

    const aboutLink = document.querySelector('.header__link[href="/src/pages/about.html"]');
    if (aboutLink) aboutLink.textContent = translations[currentLang].about;

    const categoriesLabel = document.querySelector('label[for="submenu-toggle"]');
    if (categoriesLabel) categoriesLabel.textContent = translations[currentLang].categories;

    const sportsCarsLink = document.querySelector('.header__sublink[href="/src/pages/categorias/category-deportivos.html"]');
    if (sportsCarsLink) sportsCarsLink.textContent = translations[currentLang].sportsCars;

    const raceCarsLink = document.querySelector('.header__sublink[href="/src/pages/categorias/category-carrera.html"]');
    if (raceCarsLink) raceCarsLink.textContent = translations[currentLang].raceCars;

    const searchInput = document.querySelector('.header__search-input');
    if (searchInput) searchInput.setAttribute('placeholder', translations[currentLang].searchPlaceholder);
    
    const heroTitle = document.querySelector('.hero__title');
    if (heroTitle) {
        if (document.body.classList.contains('category-carrera')) {
            heroTitle.textContent = translations[currentLang].raceCarsTitle;
        } else if (document.body.classList.contains('category-deportivos')) {
            heroTitle.textContent = translations[currentLang].sportsCarsTitle;
        } else {
            heroTitle.textContent = translations[currentLang].welcomeTitle;
        }
    }
    
    const heroSubtitle = document.querySelector('.hero__subtitle');
    if (heroSubtitle) {
        if (document.body.classList.contains('category-carrera')) {
            heroSubtitle.textContent = translations[currentLang].raceCarsSubtitle;
        } else if (document.body.classList.contains('category-deportivos')) {
            heroSubtitle.textContent = translations[currentLang].sportsCarsSubtitle;
        } else {
            heroSubtitle.textContent = translations[currentLang].welcomeSubtitle;
        }
    }
    
    const postsTitle = document.querySelector('.posts__title');
    if (postsTitle) {
        if (document.body.classList.contains('category-carrera')) {
            postsTitle.textContent = translations[currentLang].raceCarsPostsTitle;
        } else if (document.body.classList.contains('category-deportivos')) {
            postsTitle.textContent = translations[currentLang].sportsCarsPostsTitle;
        } else {
            postsTitle.textContent = translations[currentLang].recentPosts;
        }
    }
    
    const logoutButton = document.querySelector('#logoutButton');
    if (logoutButton) logoutButton.textContent = translations[currentLang].logout;

    if (currentLang === 'ar') {
        document.body.setAttribute('dir', 'rtl');
    } else {
        document.body.setAttribute('dir', 'ltr');
    }

    updateLanguageSelector();

    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (translations[currentLang][key]) {
            element.textContent = translations[currentLang][key];
        }
    });

    document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
        const key = element.getAttribute('data-i18n-placeholder');
        if (translations[currentLang][key]) {
            element.setAttribute('placeholder', translations[currentLang][key]);
        }
    });

    if (document.getElementById('post-content')) {
        updatePostContent();
    }

    const footerText = document.querySelector('.footer p');
    if (footerText) {
        footerText.textContent = translations[currentLang].footerText;
    }

    updateLoginPageContent();
}

function updatePostContent() {
    const currentLang = getCurrentLang();
    const postId = new URLSearchParams(window.location.search).get('id');
    const post = posts[postId];
    if (post) {
        document.getElementById('hero-title').textContent = post.title[currentLang];
        document.getElementById('post-author').textContent = `${translations[currentLang].by} ${post.author}`;
        document.getElementById('post-date').textContent = post.date[currentLang];
        document.getElementById('post-content').innerHTML = post.content[currentLang];
    }
}

function updateLoginPageContent() {
    const currentLang = getCurrentLang();
    const loginTitle = document.querySelector('.login__title');
    if (loginTitle) loginTitle.textContent = translations[currentLang].loginTitle;

    const usernameField = document.querySelector('.login__field:nth-child(2)');
    if (usernameField) usernameField.childNodes[0].textContent = translations[currentLang].username;

    const passwordField = document.querySelector('.login__field:nth-child(3)');
    if (passwordField) passwordField.childNodes[0].textContent = translations[currentLang].password;

    const loginButton = document.querySelector('.login__submit');
    if (loginButton) loginButton.textContent = translations[currentLang].loginButton;
}

function initializeLanguage() {
    const savedLanguage = localStorage.getItem('preferredLanguage');
    if (savedLanguage) {
        document.documentElement.lang = savedLanguage;
    }
    updateContent();
    updateLanguageSelector();
}

document.addEventListener("DOMContentLoaded", initializeLanguage);
